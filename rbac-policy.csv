# api admin: platform engineers who manage all api products
# can do: view/edit all apiproducts, approve/reject any requests, manage rbac policies
# cannot do: create/update/delete planpolicy (managed on cluster by platform engineers)
p, role:default/api-admin, kuadrant.planpolicy.read, read, allow
p, role:default/api-admin, kuadrant.planpolicy.list, read, allow
p, role:default/api-admin, kuadrant.apiproduct.create, create, allow
p, role:default/api-admin, kuadrant.apiproduct.read.all, read, allow
p, role:default/api-admin, kuadrant.apiproduct.update.all, update, allow
p, role:default/api-admin, kuadrant.apiproduct.delete.all, delete, allow
p, role:default/api-admin, kuadrant.apiproduct.list, read, allow
p, role:default/api-admin, kuadrant.httproute.list, read, allow
p, role:default/api-admin, kuadrant.apikey.create, create, allow, apiproduct:*/*
p, role:default/api-admin, kuadrant.apikey.read.all, read, allow
p, role:default/api-admin, kuadrant.apikey.update.all, update, allow
p, role:default/api-admin, kuadrant.apikey.delete.all, delete, allow
p, role:default/api-admin, kuadrant.apikey.approve, update, allow
p, role:default/api-admin, catalog.entity.read, read, allow
p, role:default/api-admin, catalog.entity.read, read, allow, api
p, role:default/api-admin, policy.entity.read, read, allow
p, role:default/api-admin, policy.entity.create, create, allow
p, role:default/api-admin, policy.entity.update, update, allow
p, role:default/api-admin, policy.entity.delete, delete, allow

# api owner: publishes apis they own, approves requests for their apis
# can do: create/update own apiproduct, approve/reject requests for own apis, read planpolicy (to reference), request api access, browse all apis
# cannot do: edit other owners' apis, create/update/delete planpolicy (managed on cluster)
p, role:default/api-owner, kuadrant.planpolicy.read, read, allow
p, role:default/api-owner, kuadrant.planpolicy.list, read, allow
p, role:default/api-owner, kuadrant.apiproduct.create, create, allow
p, role:default/api-owner, kuadrant.apiproduct.read.all, read, allow
p, role:default/api-owner, kuadrant.apiproduct.update.own, update, allow
p, role:default/api-owner, kuadrant.apiproduct.delete.own, delete, allow
p, role:default/api-owner, kuadrant.apiproduct.list, read, allow
p, role:default/api-owner, kuadrant.httproute.list, read, allow
p, role:default/api-owner, kuadrant.apikey.create, create, allow, apiproduct:*/*
p, role:default/api-owner, kuadrant.apikey.read.own, read, allow
p, role:default/api-owner, kuadrant.apikey.update.own, update, allow
p, role:default/api-owner, kuadrant.apikey.delete.own, delete, allow
p, role:default/api-owner, kuadrant.apikey.approve, update, allow
p, role:default/api-owner, catalog.entity.read, read, allow
p, role:default/api-owner, catalog.entity.read, read, allow, api

# api consumer: browses apis, requests access
# can do: read all apiproducts (for catalog browsing), create requests, manage own api keys, edit own pending requests
# cannot do: approve requests, create apis, modify rate limits, view planpolicies directly
p, role:default/api-consumer, kuadrant.apiproduct.read.all, read, allow
p, role:default/api-consumer, kuadrant.apiproduct.list, read, allow
# allow requesting access to any api (per-apiproduct access control can be added below)
p, role:default/api-consumer, kuadrant.apikey.create, create, allow, apiproduct:*/*
p, role:default/api-consumer, kuadrant.apikey.read.own, read, allow
p, role:default/api-consumer, kuadrant.apikey.update.own, update, allow
p, role:default/api-consumer, kuadrant.apikey.delete.own, delete, allow
p, role:default/api-consumer, catalog.entity.read, read, allow
p, role:default/api-consumer, catalog.entity.read, read, allow, api

# example: restrict specific apis to specific roles
# p, role:default/partner, kuadrant.apikey.create, create, allow, apiproduct:toystore/toystore-api
# p, role:default/internal, kuadrant.apikey.create, create, allow, apiproduct:internal/*

# assign groups to roles
g, group:default/api-admins, role:default/api-admin
g, group:default/api-owners, role:default/api-owner
g, group:default/api-consumers, role:default/api-consumer

# assign individual users to roles (for development with guest auth)
g, user:default/guest, role:default/api-owner
